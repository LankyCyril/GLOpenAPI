<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='utf-8'>
        <meta http-equiv='X-UA-Compatible' content='IE=edge'/>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
        <title>NASA GeneLab Data API v3 Introduction</title>
        <link rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Oxygen+Mono&family=Roboto:wght@300;500&display=swap'/>
        <style>
            * {font-size: 13pt; font-family: "Roboto", sans-serif; font-weight: 300}
            a {cursor: pointer}
            b {font-weight: 500}
            em {font-style: normal; color: #D10}
            em.remover {cursor: pointer}
            label span {border: 1px solid #BBB; display: inline-block; padding: 1.4pt 1pt; margin: 1pt 3pt; min-width: 100pt}
            h1 {font-size: 28pt; font-weight: 500; border-bottom: 1pt solid black; display: inline-block; margin: 5pt 0 20pt 0}
            h2 {font-size: 20pt; font-weight: 500; display: inline-block; margin: 10pt 0 0 0}
            #url-wrapper {display: inline-block}
            #url-description {
                display: inline-block; background: #CDF; padding: 5pt;
                border-width: 1pt 1pt 0 1pt;
                border-style: solid; border-color: #AAA;
            }
            #url {
                font-size: 12pt; font-family: "Oxygen", monospace;
                padding: 5pt; border: 1px solid #AAA;
                height: 60pt; min-height: 60pt; max-height: 50vh;
                width: 480pt; min-width: 480pt;
                word-wrap: break-word;
                overflow-y: auto;
            }
            #url-follow {
                display: inline-block; float: right; background: #DDD; padding: 5pt;
                border-width: 0 1pt 1pt 1pt;
                border-style: solid; border-color: #AAA;
            }
            #url-follow a {color: black; text-decoration: none}
            #selectors {padding-top: 25pt}
            #selectors > div {padding-bottom: 16pt}
            #selectors > div > div:first-child {width: 200pt; min-width: 200pt}
            #selectors > div > div {display: inline-block; vertical-align: top}
            #selectors > div > div ~ div {position: relative; top: -1pt}
            #selectors > div > div ~ div input {position: relative; top: 1pt}
            a.button.inactive {color: #AAA; font-style: italic; border-bottom: 1pt dashed #CCC}
        </style>
    </head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>

var url_root = "%URL_ROOT%";

function toggle_builder() {
    $("#selectors").show();
    $("#url-builder").show();
    $("h2").show();
    $("#noscript").hide();
}

function remove_query_part() {
    console.log(this.id);
}

function housekeeping() {
    $("#view option[value='']").remove();
    if ($("#view").val() == "data") {
        $(".not-for-data").css("opacity", ".3");
        $(".not-for-data input").prop("disabled", true);
    }
    else {
        $(".not-for-data").css("opacity", "1");
        $(".not-for-data input").prop("disabled", false);
    }
}

function generate_url() {
    housekeeping();
    var url = url_root;
    $("#url-description").text("Generated URL:");
    $("#url").text(url);
    $("#url-follow a").attr("href", url)
    $("#url-follow").css("background", "lightgreen");
}

$(document).ready(function() {
    toggle_builder();
    $(".remover").mouseover(function () {$(this).html("&times;")});
    $(".remover").mouseout(function () {$(this).html("&amp;")});
    $(".remover").click(remove_query_part);
    $("input[type=checkbox]").click(generate_url);
    $("select").change(generate_url);
});

</script>
    <body>
        <h1>NASA GeneLab Data API v3 Introduction</h1>
        <div id='url-builder' style='display:none'>
            <div id='url-wrapper'>
                <div id='url-description'>You are here:</div>
                <div id='url'>
                    %URL_ROOT%
                </div>
                <div id='url-follow'><a href=''>Follow generated URL</a></div>
            </div>
        </div>
        <h2 style='display:none'>Build a request:</h2>
        <div id='noscript' style='display:block'>This interactive guide requires a browser with JavaScript support</div>
        <div id='selectors' style='display:none'>
            <div>
                <div><b>View level:</b></div>
                <div>
                    <select id='view'>
                        <option value='' selected></option>
                        <option value='assays'>/assays/</option>
                        <option value='samples'>/samples/</option>
                        <option value='data'>/data/</option>
                    </select>
                </div>
            </div>
            <div class='not-for-data'>
                <div>
                    <b>Metadata, show all fields for:</b>
                    <!--<br><i>(useful for an overview<br>of assays and samples)</i>-->
                </div>
                <div>
                    <input type='checkbox' id='assay types'> <label for='assay types'><em>&amp;</em><span>assay types</span></label><br>
                    <input type='checkbox' id='factors'> <label for='factors'><em>&amp;</em><span>factors</span></label><br>
                    <input type='checkbox' id='characteristics'> <label for='characteristics'><em>&amp;</em><span>characteristics</span></label><br>
                    <input type='checkbox' id='parameters'> <label for='parameters'><em>&amp;</em><span>parameters</span></label><br>
                    <input type='checkbox' id='properties'> <label for='properties'><em>&amp;</em><span>properties</span></label><br>
                    <input type='checkbox' id='comments'> <label for='comments'><em>&amp;</em><span>comments</span></label><br>
                </div>
            </div>
            <div>
                <div><b>Subset by existence of metadata:</b></div>
                <div>
                    <div id='meta-existence-1'>
                        <input type='checkbox' id='meta-existence-1-checkbox'>
                        <em class='remover' id='meta-existence-1-remover'>&amp;</em>
                        <select id='meta-existence-1-1-fields'>
                            <option value='assay types'>assay types</option>
                            <option value='factors' selected>factors</option>
                            <option value='characteristics'>characteristics</option>
                            <option value='parameters'>parameters</option>
                            <option value='properties'>properties</option>
                            <option value='comments'>comments</option>
                        </select>
                        =
                        <select id='meta-existence-1-1-names'>
                            <option value='spaceflight' selected>spaceflight</option>
                        </select>
                        <a id='meta-existence-1-1-or' class='button inactive'>OR</a>
                    </div>
                    <div id='meta-existence-N'>
                        <input type='checkbox' disabled>
                        <a id='meta-existence-N-add' class='button inactive'>AND</a>
                    </div>
                </div>
            </div>
            <div>
                <div><b>Exclude metadata fields:</b></div>
                <div>
                    <div id='meta-exclude-1'>
                        <input type='checkbox' id='meta-exclude-1-checkbox'>
                        <em class='remover' id='meta-exclude-1-remover'>&amp;</em>
                        <select id='meta-exclude-1-fields'>
                            <option value='assay types'>assay types</option>
                            <option value='factors' selected>factors</option>
                            <option value='characteristics'>characteristics</option>
                            <option value='parameters'>parameters</option>
                            <option value='properties'>properties</option>
                            <option value='comments'>comments</option>
                        </select>
                        !=
                        <select id='meta-exclude-1-names'>
                            <option value='spaceflight' selected>ionizing radiation</option>
                        </select>
                    </div>
                    <div id='meta-exclude-N'>
                        <input type='checkbox' disabled>
                        <a id='meta-exclude-N-add' class='button inactive'>AND</a>
                    </div>
                </div>
            </div>
            <div>
                <div><b>Subset by metadata values:</b></div>
                <div>
                    <div id='meta-value-equals-1'>
                        <input type='checkbox' id='meta-value-equals-1-checkbox'>
                        <em class='remover' id='meta-value-equals-1-remover'>&amp;</em>
                        <select id='meta-value-equals-1-1-fields'>
                            <option value='assay types'>assay types</option>
                            <option value='factors' selected>factors</option>
                            <option value='characteristics'>characteristics</option>
                            <option value='parameters'>parameters</option>
                            <option value='properties'>properties</option>
                            <option value='comments'>comments</option>
                        </select>
                        :
                        <select id='meta-value-equals-1-1-names'>
                            <option value='spaceflight' selected>spaceflight</option>
                        </select>
                        =
                        <select id='meta-value-equals-1-1-values'>
                            <option value='Ground Control' selected>Ground Control</option>
                        </select>
                        <a id='meta-value-equals-1-1-or' class='button inactive'>OR</a>
                    </div>
                    <div id='meta-value-equals-N'>
                        <input type='checkbox' disabled>
                        <a id='meta-value-equals-N-add' class='button inactive'>AND</a>
                    </div>
                </div>
            </div>
            <div>
                <div><b>Filter out metadata values:</b></div>
                <div>
                    <div id='meta-value-notequals-1'>
                        <input type='checkbox' id='meta-value-notequals-1-checkbox'>
                        <em class='remover' id='meta-value-notequals-1-remover'>&amp;</em>
                        <select id='meta-value-notequals-1-fields'>
                            <option value='assay types'>assay types</option>
                            <option value='factors' selected>factors</option>
                            <option value='characteristics'>characteristics</option>
                            <option value='parameters'>parameters</option>
                            <option value='properties'>properties</option>
                            <option value='comments'>comments</option>
                        </select>
                        :
                        <select id='meta-value-notequals-1-names'>
                            <option value='spaceflight' selected>spaceflight</option>
                        </select>
                        !=
                        <select id='meta-value-notequals-1-values'>
                            <option value='Basal Control' selected>Basal Control</option>
                        </select>
                    </div>
                    <div id='meta-value-notequals-N'>
                        <input type='checkbox' disabled>
                        <a id='meta-value-notequals-N-add' class='button inactive'>AND</a>
                    </div>
                </div>
            </div>
            <div>
                <div><b>Subset by datasets and assays:</b></div>
                <div>
                    <div id='select-1'>
                        <input type='checkbox' id='select-1-checkbox'>
                        <em class='remover' id='select-1-remover'>&amp;</em>
                        <select id='select-1-accessions'>
                            <option value='GLDS-1' selected>GLDS-1</option>
                            <option value='GLDS-2'>GLDS-2</option>
                            <option value='GLDS-3'>GLDS-3</option>
                        </select>
                        :
                        <select id='select-1-names'>
                            <option value='' selected></option>
                            <option value='a_E-GEOD-53196_GeneChip_assay-txt'>a_E-GEOD-53196_GeneChip_assay-txt</option>
                        </select>
                    </div>
                    <div id='select-N'>
                        <input type='checkbox' disabled>
                        <a id='select-N-add' class='button inactive'>OR</a>
                    </div>
                </div>
            </div>
            <div>
                <div><b>Display in format:</b></div>
                <div>
                    <em>&ampfmt=</em>
                    <select id='fmt'>
                        <option value='browser' selected>browser</option>
                        <option value='html'>html</option>
                        <option value='tsv'>tsv</option>
                        <option value='csv'>csv</option>
                    </select>
                </div>
            </div>
        </div>
    </body>
</html>
