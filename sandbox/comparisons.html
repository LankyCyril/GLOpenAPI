<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title></title>
    <style>
        * {font-family: Roboto; padding: 0; margin: 0}
        body {margin: 10pt; margin-top: -40pt}
        tr {vertical-align: top}
        td {white-space: pre-line; padding-right: 30pt;}
        red {color: #D10}
        green {color: #0A1}
        orange {color: #A80}
        a {color: #22B}
        /*td:last-of-type:not(:first-of-type) {padding-bottom: 50pt}*/
        h2 {padding-top: 40pt; margin-bottom: -10pt}
        h4 {padding-top: 35pt; margin-bottom: -7pt}
    </style>
    </head>
    <body>
        <table><tr>


</tr><tr><td colspan=3><h2>Syntax to show metadata columns w/o querying</h2></td></tr><tr>

</tr><tr><td colspan=3><h4>Note that with /data/, querying for a column name keeps NAs</h4></td></tr><tr>
<td>
    Before:
    <green>(logical behavior)</green>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/data/?format=browser&id=GLDS-1&file.datatype=visualization%20table&column.ENSEMBL&column.ENTREZID">
    /data/
    ?id=GLDS-1
    &file.datatype=visualization table
    &column.ENSEMBL
    &column.ENTREZID</a>
</td>
<td>
    Same syntax after:
    <green>(logical behavior retained)</green>
    <a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=visualization%20table&column.ENSEMBL&column.ENTREZID">
    /data/
    ?id=GLDS-1
    &file.datatype=visualization table
    &column.ENSEMBL
    &column.ENTREZID</a>
</td>

</tr><tr><td colspan=3><h4>With /samples/ (and /assays/), however, asking for a column used to remove entires where it's NA</h4></td></tr><tr>
<td>
    Before:
    <red>(filters out NAs in column – inconsistent with /data/ behavior <b>and user expectations</b>)</red>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/samples/?format=browser&study.factor%20value.altitude&study.factor%20value.time">
    /samples/
    ?study.factor value.altitude
    &study.factor value.time</a>
</td>
<td>
    Same syntax after:
    <green>(show columns even if there's no data – consistent with /data/ behavior <b>and user expectations</b>)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&study.factor%20value.altitude&study.factor%20value.time">
    /samples/
    ?study.factor value.altitude
    &study.factor value.time</a>
</td>
<td>
    Equivalent syntax after:
    <green>(think colA&ne;NA &amp; colB&ne;NA)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&=study.factor%20value.altitude&=study.factor%20value.time">
    /samples/
    ?=study.factor value.altitude
    &=study.factor value.time</a>
</td>

</tr><tr><td colspan=3><h4>Include columns with NAs while querying for others that are non-NA</h4></td></tr><tr>
<td>
    Before:
    <red>Impossible</red>
</td>
<td>
    Same syntax after:
    Not applicable
</td>
<td>
    Correct syntax after:
    <green>(think "any colA" &amp; colB&ne;NA)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&study.factor%20value.altitude&=study.factor%20value.time">
    /samples/
    ?study.factor value.altitude
    &=study.factor value.time</a>
</td>

</tr><tr><td colspan=3><h4>Include columns with NAs while querying for specific values in others</h4></td></tr><tr>
<td>
    Before:
    <red>Impossible</red>
</td>
<td>
    Same syntax <b><i>before</i></b>:
    <red>(subsets to non-NA in colA)</red>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/samples/?format=browser&study.factor%20value.altitude&study.factor%20value.time=day%200">
    /samples/
    ?study.factor value.altitude
    &study.factor value.time=day 0</a>
</td>
<td>
    Correct syntax after:
    <green>(think "any colA" &amp; colB=X)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&study.factor%20value.altitude&study.factor%20value.time=day%200">
    /samples/
    ?study.factor value.altitude
    &study.factor value.time=day 0</a>
</td>

</tr><tr><td colspan=3><h4><green>Querying within one assay is unaffected by these changes (AFAIK what viz is doing)</green></h4></td></tr><tr>
<td>
    Before:
    <green>(column values are defined for all samples)</green>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/samples/?format=browser&id=GLDS-1&study.factor%20value.infection=uninfected&study.factor%20value.spaceflight">
    /samples/
    ?id=GLDS-1
    &study.factor value.infection=uninfected
    &study.factor value.spaceflight</a>
</td>
<td>
    Same syntax after:
    <green>(column values are defined for all samples)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&id=GLDS-1&study.factor%20value.infection=uninfected&study.factor%20value.spaceflight">
    /samples/
    ?id=GLDS-1
    &study.factor value.infection=uninfected
    &study.factor value.spaceflight</a>
</td>
<td>
    Equivalent syntax after:
    <green>(optional; adding the '=' symbol makes no difference)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&id=GLDS-1&study.factor%20value.infection=uninfected&=study.factor%20value.spaceflight">
    /samples/
    ?id=GLDS-1
    &study.factor value.infection=uninfected
    &=study.factor value.spaceflight</a>
</td>


</tr><tr><td colspan=3><h2>Consistency of what's shown by default</h2></td></tr><tr>

</tr><tr><td colspan=3><h4>Note that with /data/, absence of column queries means "show all columns"</h4></td></tr><tr>
<td>
    Before:
    <green>(logical behavior)</green>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/data/?format=browser&id=GLDS-1&file.datatype=pca">
    /data/
    ?id=GLDS-1
    &file.datatype=pca</a>
</td>
<td>
    Same syntax after:
    <green>(logical behavior retained)</green>
    <a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=pca">
    /data/
    ?id=GLDS-1
    &file.datatype=pca</a>
</td>
<td>
</td>

</tr><tr><td colspan=3><h4>With /samples/ (or /assays/), absence of queries used to mean "show nothing but id" – now will mean "show all"</h4></td></tr><tr>
<td>
    Before:
    <red>(technically OK, but inconsistent w/ data behavior)</red>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/samples/?format=browser">
    /samples/</a>
</td>
<td>
    Same syntax after:
    <green>(all columns: consistent w/ data behavior)</green>
    <orange>(note: it's yuge)</orange>
    <a href="http://127.0.0.1:5000/samples/?format=browser">
    /samples/</a>
</td>
<td>
    Equivalent syntax after:
    <red>(none, but that's OK? did anyone ever need a metadata table without any ISA metadata?)</red>
</td>


</tr><tr><td colspan=3><h2>Consistency of what's shown when queried, i.e. the default is overridden</h2></td></tr><tr>

</tr><tr><td colspan=3><h4>Note that with /samples/ (or /assays/), including a column as a query adds it to output, hides non-requested ones:</h4></td></tr><tr>
<td>
    Before:
    <green>(logical behavior)</green>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/samples/?format=browser&study.factor%20value.altitude=10,000%20{foot}">
    /samples/
    ?study.factor value.altitude=10,000 {foot}</a>
</td>
<td>
    Same syntax after:
    <green>(logical behavior retained)</green>
    <a href="http://127.0.0.1:5000/samples/?format=browser&study.factor%20value.altitude=10,000%20{foot}">
    /samples/
    ?study.factor value.altitude=10,000 {foot}</a>
</td>
<td>
</td>

</tr><tr><td colspan=3><h4>However, for /data/ it just filtered values – now will hide non-requested columns</h4></td></tr><tr>
<td>
    Before:
    <red>(does not hide other columns, inconsistent w/ metadata behavior)</red>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/data/?format=browser&id=GLDS-1&file.datatype=pca&column.PC1%3E0">
    /data/
    ?id=GLDS-1
    &file.datatype=pca
    &column.PC1>0</a>
</td>
<td>
    Same syntax after:
    <green>(hides other columns, consistent w/ metadata behavior)</green>
    <a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=pca&column.PC1%3E0">
    /data/
    ?id=GLDS-1
    &file.datatype=pca
    &column.PC1>0</a>
</td>
<td>
    Equivalent syntax after:
    <green>(does not hide other columns)</green>
    <a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=pca&column.PC1%3E0&column.*">
    /data/
    ?id=GLDS-1
    &file.datatype=pca
    &column.PC1>0
    &column.*</a>
</td>

</tr><tr><td colspan=3><h4><green>Querying for data columns while also "asking to show" is unaffected</green> – <orange>is that what Viz is doing?</orange></h4></td></tr><tr>
<td>
    Before:
    <green>(asked for the column explicitly)</green>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/data/?format=browser&id=GLDS-1&file.datatype=pca&column.PC1%3E0&column.PC1">
    /data/
    ?id=GLDS-1
    &file.datatype=pca
    &column.PC1>0
    &column.PC1</a>
</td>
<td>
    Same syntax after:
    <green>(asked for the same column twice, will still get it once)</green>
    <a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=pca&column.PC1%3E0&column.PC1">
    /data/
    ?id=GLDS-1
    &file.datatype=pca
    &column.PC1>0
    &column.PC1</a>
</td>
<td>
</td>


</tr><tr><td colspan=3><h2>Work in progress</h2></td></tr><tr>

</tr><tr><td colspan=3><h4>Recall that for /data/, just including "&amp;column.Whatever" is <u><i>already</i></u> equivalent to "show this column" – i.e. w/o subsetting to non-NA</h4></td></tr><tr>
<td>
    Before:
    <green>(logical behavior)</green>
    <a href="https://visualization.genelab.nasa.gov/GLOpenAPI/data/?format=browser&id=GLDS-1&file.datatype=visualization%20table&c.ENSEMBL">
    /data/
    ?id=GLDS-1
    &file.datatype=visualization table
    &column.ENSEMBL</a>
</td>
<td>
    Same syntax after:
    <green>(logical behavior retained)</green>
    <a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=visualization%20table&column.ENSEMBL">
    /data/
    ?id=GLDS-1
    &file.datatype=visualization table
    &column.ENSEMBL</a>
</td>
<td>
    <red>Syntax to subset to non-NA (i.e. "&=column.ENSEMBL") – WIP. Do we need it? We probably do... Here's to some SQLite3 fun</red>
    <s><a href="http://127.0.0.1:5000/data/?format=browser&id=GLDS-1&file.datatype=visualization%20table&=column.ENSEMBL" style="color: #D10 !important">
    /data/
    ?id=GLDS-1
    &file.datatype=visualization table
    &=column.ENSEMBL</a></s>
</td>

        </tr></table>
    </body>
</html>
